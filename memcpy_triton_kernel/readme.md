(triton) coder@candy-npu:~/workspace/sglang-test/memcpy_triton_kernel$ python test_memcpy_triron_kernel.py 

[MEMCPY TRITON KERNEL REAL DATA]
dst:
  Shape: torch.Size([4, 2048])
  Dtype: torch.bfloat16
  Device: cpu
  First 10 elements: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
src:
  Shape: torch.Size([4, 2048])
  Dtype: torch.bfloat16
  Device: cpu
  First 10 elements: [0.0045166015625, -0.00823974609375, 0.0179443359375, 0.01300048828125, 3.0517578125e-05, -0.0028076171875, -0.01483154296875, -0.0145263671875, 0.001251220703125, 0.010498046875]
offset:
  Shape: torch.Size([])
  Dtype: torch.int64
  Device: cpu
  First 10 elements: [0]
sz:
  Shape: torch.Size([])
  Dtype: torch.int32
  Device: cpu
  First 10 elements: [2]
offset_src: False
chunk_size: 2048
BLOCK_SIZE: 8192
>>> Compare Type: bfloat16
Max diff at (tensor(0, device='npu:0'), tensor(1992, device='npu:0')): test=-0.5703125, ref=0.0, abs=0.5703125, rel=569344.0
精度不达标 (2946/8192, 35.961914% > 0.500000%)
(0, 1): test=-0.008240, ref=0.000000, diff=0.008240, rel=8256.000000
(0, 2): test=0.017944, ref=0.000000, diff=0.017944, rel=17920.000000
(0, 3): test=0.013000, ref=0.000000, diff=0.013000, rel=12992.000000
(0, 6): test=-0.014832, ref=0.000000, diff=0.014832, rel=14848.000000
(0, 7): test=-0.014526, ref=0.000000, diff=0.014526, rel=14528.000000
(0, 9): test=0.010498, ref=0.000000, diff=0.010498, rel=10496.000000
(0, 10): test=-0.011414, ref=0.000000, diff=0.011414, rel=11456.000000
(0, 15): test=-0.010986, ref=0.000000, diff=0.010986, rel=11008.000000
(0, 16): test=0.021851, ref=0.000000, diff=0.021851, rel=21888.000000
(0, 17): test=-0.018555, ref=0.000000, diff=0.018555, rel=18560.000000
-------- DEBUG INFO --------
Test Dst Tensor(first 100 elements):
[0.0045166015625, -0.00823974609375, 0.0179443359375, 0.01300048828125, 3.0517578125e-05, -0.0028076171875, -0.01483154296875, -0.0145263671875, 0.001251220703125, 0.010498046875, -0.01141357421875, 0.0010986328125, -0.0024261474609375, -0.00146484375, -0.00048828125, -0.010986328125, 0.0218505859375, -0.0185546875, -0.0040283203125, 0.0218505859375, 0.00628662109375, 0.00213623046875, -0.0111083984375, -0.0009765625, -0.00421142578125, 0.01336669921875, 0.00213623046875, 0.001617431640625, -0.00640869140625, 0.00018310546875, -0.0184326171875, -0.0098876953125, -0.0262451171875, 0.06201171875, 0.001708984375, 0.027099609375, 0.022216796875, 0.017822265625, 0.00555419921875, -0.0203857421875, 0.010009765625, -0.0037689208984375, -0.043212890625, -0.01239013671875, 0.015869140625, 0.0150146484375, -0.018310546875, 0.01318359375, 0.0034332275390625, 0.01123046875, 0.004241943359375, -0.012939453125, 0.00140380859375, 0.0230712890625, 0.03466796875, 0.017333984375, 0.0025634765625, -0.00445556640625, 0.021240234375, -0.00421142578125, 0.0057373046875, 0.022216796875, 0.0003948211669921875, 0.035888671875, 0.009521484375, -0.0419921875, 0.0019989013671875, -0.00445556640625, -0.0140380859375, 0.0096435546875, -0.0005950927734375, 0.00042724609375, -0.0010986328125, -0.017822265625, -0.016357421875, 0.0072021484375, -0.00090789794921875, -0.006072998046875, -0.0167236328125, 0.00372314453125, -0.01171875, 0.002960205078125, 0.017333984375, 0.0147705078125, -0.0120849609375, 0.015869140625, -0.00469970703125, -0.0220947265625, -0.00146484375, -0.01373291015625, 0.0155029296875, 0.02099609375, -0.00244140625, 0.0012359619140625, 0.0087890625, 0.000732421875, -0.0084228515625, 0.001434326171875, -0.0018310546875, 0.026611328125]
Expected Output Tensor(first 100 elements):
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
-------- DEBUG INFO --------